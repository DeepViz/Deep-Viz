"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),_react=require("react"),_react2=_interopRequireDefault(_react),DataScatter=function(t){function e(){_classCallCheck(this,e);var t=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.animate=function(){t.context=t.canvas.getContext("2d"),t.context.clearRect(0,0,t.canvas.width,t.canvas.height);var e=void 0;t.squareArray.forEach(function(t){t.createOutlinePath(),t.drawOutlinePath();var i=t.circlesArray,r=i.length;for(e=0;e<r;e++){var s=i[e];s.x+=s.vx,s.y+=s.vy,(s.x<t.left+s.radius||s.x>t.right-s.radius)&&(s.vx=-s.vx),(s.y<t.top+s.radius||s.y>t.bottom-s.radius)&&(s.vy=-s.vy),s.createCirclePath(),s.drawCirclePath()}}),window.requestAnimationFrame(t.animate.bind(t))},t.mousemove=function(e){var i=t.canvas.getBoundingClientRect(),r=(e.clientX-i.left)*t.scaleratio,s=(e.clientY-i.top)*t.scaleratio,o=void 0,a=t.squareArray;for(t.currentSqu&&(t.currentSqu.div.style.opacity=0),o=a.length-1;o>=0;o--)if(a[o].isPointInPath(r,s)){t.currentSqu=a[o],t.currentSqu.div.style.opacity=1;break}},t.mouseout=function(){t.currentSqu&&(t.currentSqu.div.style.opacity=0)},t.id=Math.random()+"-canvas",t.color=["#FDB933","#D64F44","#00A6AC","#1D953F","#E0861A","#45B97C","#F3715C","#F26522","#7FB80E","#63C5FA"],t.squareArray=[],t.scaleratio=2,t.Square=function(t,e,i,r,s,o){this.x=t,this.y=e,this.width=i,this.height=r,this.scaleratio=s,this.context=o,this.content=[],this.circlesArray=[]},t.Square.prototype.caculate=function(){this.left=this.x,this.top=this.y,this.right=this.x+this.width,this.bottom=this.y+this.height,this.cx=this.x+this.width/2,this.cy=this.y+this.height/2},t.Square.prototype.createOutlinePath=function(){this.context.beginPath(),this.context.strokeRect(this.x,this.y,this.width,this.height),this.context.closePath()},t.Square.prototype.drawOutlinePath=function(){this.context.save(),this.context.strokeStyle="rgba(171,171,171,0.4)",this.context.stroke(),this.context.restore()},t.Square.prototype.createToolTip=function(){this.div=document.createElement("div"),this.div.style.position="absolute",this.div.style.top=this.y/this.scaleratio+"px",this.div.style.width=this.width/this.scaleratio+"px",this.div.style.height=this.height/this.scaleratio+"px",this.div.style.left=this.x/this.scaleratio+"px",this.div.style.transition="opacity .2s linear",this.div.style.background="rgba(50, 50, 50, 0.7)",this.div.style.textAlign="center",this.div.style.opacity=0;var t=document.createElement("div");t.style.textAlign="center",t.style.color="#fff",t.style.marginTop=this.height/this.scaleratio/3+"px",t.innerText=this.content.title,this.div.appendChild(t),this.context.canvas.parentNode.appendChild(this.div)},t.Square.prototype.isPointInPath=function(t,e){return t>this.left&&t<this.right&&e>this.top&&e<this.bottom},t.Circle=function(t,e,i,r,s,o,a){this.x=t,this.y=e,this.radius=i,this.color=r,this.vx=s,this.vy=o,this.context=a},t.Circle.prototype.createCirclePath=function(){this.context.beginPath(),this.context.arc(this.x,this.y,this.radius,0,2*Math.PI)},t.Circle.prototype.drawCirclePath=function(){this.context.save(),this.context.fillStyle=this.color,this.context.fill(),this.context.restore()},t}return _inherits(e,_react2.default.Component),_createClass(e,[{key:"componentDidMount",value:function(){this.canvas=document.getElementById(this.id),this.context=this.canvas.getContext("2d");var t=window.getComputedStyle(this.canvas.parentNode),e=Math.floor(window.parseInt(t.width)),i=Math.floor(window.parseInt(t.height));if(this.canvas.width=e*this.scaleratio,this.canvas.height=i*this.scaleratio,this.canvas.style.width=e+"px",this.canvas.style.height=i+"px",this.rect=this.canvas.getBoundingClientRect(),Array.isArray(this.props.items)){var r=this.props.col||this.props.items.length||1,s=this.props.row||1,o=Math.floor(e*this.scaleratio/r),a=Math.floor(i*this.scaleratio/s),n=void 0,h=void 0;for(n=0;n<r;n++){var c=n*o;for(h=0;h<s;h++){var l=h*a,u=new this.Square(c,l,o,a,this.scaleratio,this.canvas.getContext("2d"));u.caculate(),this.squareArray.push(u)}}this.items=this.props.items;var d=this.items,p=this.squareArray.length;for(n=0;n<p;n++){var y=this.squareArray[n];if(d[n]){y.content=d[n];var f=y.content.num,v=Math.min(y.width,y.height),x=this.color[Math.floor(11*Math.random())],g=2*Math.PI/f;for(h=0;h<f;h++){var m=Math.random()*v*.02+.01*v,w=new this.Circle(y.cx,y.cy,m,x,2*Math.cos(g*h),2*Math.sin(g*h),this.context=this.canvas.getContext("2d"));y.circlesArray.push(w)}y.createToolTip()}}window.requestAnimationFrame(this.animate.bind(this))}}},{key:"render",value:function(){return _react2.default.createElement("div",{onMouseMove:this.mousemove,onMouseOut:this.mouseout,style:{position:"relative",width:"100%",height:"100%",overflow:"none",cursor:"pointer"}},_react2.default.createElement("canvas",{id:this.id},"对不起，您的浏览器不支持canvas"))}}]),e}();exports.default=DataScatter;